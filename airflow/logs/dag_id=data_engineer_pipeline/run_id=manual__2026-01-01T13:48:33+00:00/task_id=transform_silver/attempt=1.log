{"timestamp":"2026-01-01T13:48:45.065794Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-01-01T13:48:45.066478Z","level":"info","event":"Filling up the DagBag from /home/cahya/Documents/PROJECT/LocalDataEngineer/airflow/dags/de_pipeline_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-01-01T13:48:45.118060Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.118210Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.118509Z","level":"info","event":"Current task name:transform_silver","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.118605Z","level":"info","event":"Dag name:data_engineer_pipeline","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.141900Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1008,"error_detail":[{"exc_type":"ProgrammingError","exc_value":"(psycopg2.errors.DuplicateObject) constraint \"chk_total_price_positive\" for relation \"sales\" already exists\n\n[SQL: \n    CREATE TABLE IF NOT EXISTS silver.sales (\n        order_id INT PRIMARY KEY,\n        user_id INT NOT NULL,\n        product TEXT,\n        total_price NUMERIC NOT NULL,\n        order_date DATE NOT NULL\n    );\n        \n    ALTER TABLE silver.sales\n        ALTER COLUMN order_id SET NOT NULL,\n        ALTER COLUMN total_price SET NOT NULL,\n        ALTER COLUMN order_date SET NOT NULL;\n\n    ALTER TABLE silver.sales\n        ADD CONSTRAINT chk_total_price_positive CHECK (total_price > 0);\n\n\n    INSERT INTO silver.sales\n    SELECT\n        order_id,\n        user_id,\n        product,\n        price * quantity AS total_price,\n        DATE(order_date)\n    FROM bronze.transactions\n    ON CONFLICT (order_id) DO NOTHING;\n    ]\n(Background on this error at: https://sqlalche.me/e/14/f405)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":934,"name":"run"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1325,"name":"_execute_task"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":417,"name":"wrapper"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":215,"name":"execute"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":238,"name":"execute_callable"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/etl/silver_transform.py","lineno":37,"name":"transform_silver"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1385,"name":"execute"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py","lineno":334,"name":"_execute_on_connection"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1577,"name":"_execute_clauseelement"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1953,"name":"_execute_context"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2134,"name":"_handle_dbapi_exception"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/util/compat.py","lineno":211,"name":"raise_"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]},{"exc_type":"DuplicateObject","exc_value":"constraint \"chk_total_price_positive\" for relation \"sales\" already exists\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/cahya/Documents/PROJECT/LocalDataEngineer/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-01-01T13:48:45.183867Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184131Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184246Z","level":"info","event":"Task:<Task(PythonOperator): transform_silver>","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184308Z","level":"info","event":"Failure caused by (psycopg2.errors.DuplicateObject) constraint \"chk_total_price_positive\" for relation \"sales\" already exists","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184353Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184401Z","level":"info","event":"[SQL:","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184443Z","level":"info","event":"    CREATE TABLE IF NOT EXISTS silver.sales (","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184483Z","level":"info","event":"        order_id INT PRIMARY KEY,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184526Z","level":"info","event":"        user_id INT NOT NULL,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184566Z","level":"info","event":"        product TEXT,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184606Z","level":"info","event":"        total_price NUMERIC NOT NULL,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184645Z","level":"info","event":"        order_date DATE NOT NULL","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184682Z","level":"info","event":"    );","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184722Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184761Z","level":"info","event":"    ALTER TABLE silver.sales","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184799Z","level":"info","event":"        ALTER COLUMN order_id SET NOT NULL,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184838Z","level":"info","event":"        ALTER COLUMN total_price SET NOT NULL,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184875Z","level":"info","event":"        ALTER COLUMN order_date SET NOT NULL;","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184914Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184953Z","level":"info","event":"    ALTER TABLE silver.sales","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.184991Z","level":"info","event":"        ADD CONSTRAINT chk_total_price_positive CHECK (total_price > 0);","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185030Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185066Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185103Z","level":"info","event":"    INSERT INTO silver.sales","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185150Z","level":"info","event":"    SELECT","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185189Z","level":"info","event":"        order_id,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185274Z","level":"info","event":"        user_id,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185321Z","level":"info","event":"        product,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185370Z","level":"info","event":"        price * quantity AS total_price,","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185410Z","level":"info","event":"        DATE(order_date)","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185457Z","level":"info","event":"    FROM bronze.transactions","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185497Z","level":"info","event":"    ON CONFLICT (order_id) DO NOTHING;","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185582Z","level":"info","event":"    ]","logger":"task.stdout"}
{"timestamp":"2026-01-01T13:48:45.185629Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"task.stdout"}
